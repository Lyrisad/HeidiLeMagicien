<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Heidi • Magicien Professionnel</title>
  <meta name="description" content="Une étincelle suffit pour allumer l’impossible. Magicien professionnel pour anniversaires, mariages, entreprises et close-up.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="global-glow" aria-hidden="true"></div>
  <header class="site-header">
    <div class="container header-inner">
      <a href="#accueil" class="brand">
        <img class="brand-logo" src="img/Logo.png" alt="Heidi Magicien" />
        <span class="brand-name">Heidi Le Magicien</span>
      </a>
      <nav class="site-nav" aria-label="Navigation principale">
        <button class="nav-toggle" aria-expanded="false" aria-controls="nav-menu">Menu</button>
        <ul id="nav-menu" class="nav-list">
          <li><a href="#accueil"><span class="nav-suit nav-spark" aria-hidden="true">&#10022;</span>Accueil</a></li>
          <li><a href="presentation.html"><span class="nav-suit" aria-hidden="true">&#9824;</span>Présentation</a></li>
          <li class="has-submenu">
            <a href="#prestations"><span class="nav-suit" aria-hidden="true">&#9827;</span>Prestations <span class="nav-caret" aria-hidden="true">▾</span></a>
            <div class="submenu" role="menu" aria-label="Prestations">
              <a href="anniversaire.html" role="menuitem"><span class="menu-suit">♦</span><span>Anniversaire</span></a>
              <a href="closeup.html" role="menuitem"><span class="menu-suit">♠</span><span>Close-up</span></a>
              <a href="mariage.html" role="menuitem"><span class="menu-suit">♥</span><span>Mariage</span></a>
              <a href="entreprise.html" role="menuitem"><span class="menu-suit">♣</span><span>Entreprise</span></a>
            </div>
          </li>
          <li><a href="#media"><span class="nav-suit" aria-hidden="true">&#9830;</span>Réseaux</a></li>
          <li><a href="#avis"><span class="nav-suit" aria-hidden="true">&#9733;</span>Avis</a></li>
          <li><a href="#contact"><span class="nav-suit" aria-hidden="true">&#9829;</span>Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="accueil" class="hero">
    <div class="container hero-inner">
      <div class="hero-copy">
        <div class="hero-slogan">
          <canvas class="hero-particles" aria-hidden="true"></canvas>
          <h1 class="hero-title">Une <span class="word-spark">étincelle</span> suffit pour allumer l’<span class="word-impossible">impossible</span>.</h1>
        </div>
        <p class="hero-sub">Magie moderne, élégante et immersive — pour sublimer vos événements.</p>
        <div class="hero-cta">
          <a class="btn btn-primary" href="#prestations">Découvrir les prestations</a>
          <a class="btn btn-ghost" href="#contact">Formulaire de contact</a>
        </div>
      </div>
      <div class="hero-media">
        <picture>
          <source srcset="img/HeidiFire.png" type="image/png">
          <img src="img/Heidi.png" alt="Heidi le Magicien" loading="eager" />
        </picture>
      </div>
    </div>
  </main>

  
  
  
  
  <section id="prestations" class="section prestations">
    <div class="container">
      <header class="section-head">
        <h2 class="section-title">Prestations</h2>
        <p class="section-sub">Des instants suspendus, des regards émerveillés, des sourires d’enfant retrouvés.<br>Qu’il s’agisse d’un anniversaire, d’un mariage, d’une soirée d’entreprise ou d’un close-up intimiste, chaque prestation est une invitation à rêver et à redécouvrir la magie sous un nouveau jour.</p>
        <p class="section-hint">Cliquez sur les cartes pour découvrir mes prestations.</p>
      </header>
      <div class="cards playing-cards" role="list">
        <div class="playing-card" role="listitem" tabindex="0" aria-pressed="false" aria-label="Spectacle anniversaire enfants">
          <span class="card-inner">
            <span class="card-face card-back" aria-hidden="true">
              <img src="img/DosCartes.png" alt="Dos de carte à jouer" />
            </span>
            <span class="card-face card-front">
              <span class="card-front-content">
                <span class="card-suit" aria-hidden="true">&#9830;</span>
                <span class="card-kicker">Anniversaire</span>
                <span class="card-title">Anniversaire enfant</span>
                <span class="card-actions">
                  <a class="btn btn-ghost btn-sm card-link" href="anniversaire.html" onclick="event.stopPropagation();" aria-label="Découvrir la prestation Anniversaire">Découvrir</a>
                </span>
              </span>
            </span>
          </span>
        </div>

        <div class="playing-card" role="listitem" tabindex="0" aria-pressed="false" aria-label="Close-up">
          <span class="card-inner">
            <span class="card-face card-back" aria-hidden="true">
              <img src="img/DosCartes.png" alt="Dos de carte à jouer" />
            </span>
            <span class="card-face card-front">
              <span class="card-front-content">
                <span class="card-suit" aria-hidden="true">&#9824;</span>
                <span class="card-kicker">Close-Up</span>
                <span class="card-title">Magie de proximité</span>
                <span class="card-actions">
                  <a class="btn btn-ghost btn-sm card-link" href="closeup.html" onclick="event.stopPropagation();" aria-label="Découvrir la prestation Close-up">Découvrir</a>
                </span>
              </span>
            </span>
          </span>
        </div>

        <div class="playing-card" role="listitem" tabindex="0" aria-pressed="false" aria-label="Mariage">
          <span class="card-inner">
            <span class="card-face card-back" aria-hidden="true">
              <img src="img/DosCartes.png" alt="Dos de carte à jouer" />
            </span>
            <span class="card-face card-front">
              <span class="card-front-content">
                <span class="card-suit" aria-hidden="true">&#9829;</span>
                <span class="card-kicker">Mariage</span>
                <span class="card-title">Élégance et émotion</span>
                <span class="card-actions">
                  <a class="btn btn-ghost btn-sm card-link" href="mariage.html" onclick="event.stopPropagation();" aria-label="Découvrir la prestation Mariage">Découvrir</a>
                </span>
              </span>
            </span>
          </span>
        </div>

        <div class="playing-card" role="listitem" tabindex="0" aria-pressed="false" aria-label="Entreprise">
          <span class="card-inner">
            <span class="card-face card-back" aria-hidden="true">
              <img src="img/DosCartes.png" alt="Dos de carte à jouer" />
            </span>
            <span class="card-face card-front">
              <span class="card-front-content">
                <span class="card-suit" aria-hidden="true">&#9827;</span>
                <span class="card-kicker">Entreprise</span>
                <span class="card-title">Événements pros</span>
                <span class="card-actions">
                  <a class="btn btn-ghost btn-sm card-link" href="entreprise.html" onclick="event.stopPropagation();" aria-label="Découvrir la prestation Entreprise">Découvrir</a>
                </span>
              </span>
            </span>
          </span>
        </div>
      </div>
    </div>
  </section>

  

  <section id="media" class="section media">
    <div class="container media-inner">
      <div class="phone-wrap">
        <div class="phone-bg" aria-hidden="true">
          <canvas class="phone-particles"></canvas>
        </div>
        <div class="phone">
          <div class="phone-notch" aria-hidden="true"></div>
          <video class="phone-video" src="img/video.mov" autoplay muted loop playsinline controlslist="nodownload noplaybackrate" aria-label="Aperçu vidéo"></video>
        </div>
      </div>
      <aside class="media-aside">
        <header class="section-head">
          <h2 class="section-title">Suivez la magie</h2>
          <p class="section-sub">N’hésitez pas à me suivre sur les réseaux&nbsp;!</p>
        </header>
        <ul class="chip-list" aria-label="Thématiques disponibles">
          <li><span class="chip">Reels</span></li>
          <li><span class="chip">Tours de pièces</span></li>
          <li><span class="chip">Cartes</span></li>
          <li><span class="chip">sneaky ball</span></li>
        </ul>
        <p class="media-desc">Découvrez des reels captivants et des extraits exclusifs mêlant illusions de pièces, cartomagie, sneaky ball et bien plus encore. Laissez la flamme de la magie éveiller votre curiosité et plongez dans un univers où chaque geste cache un mystère, chaque tour une émotion.</p>
        <ul class="social-list">
          <li>
            <a class="social" href="https://www.instagram.com/heidilemagicien/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 5a5 5 0 1 0 0 10a5 5 0 0 0 0-10zm6.5-.75a1.25 1.25 0 1 0 0 2.5a1.25 1.25 0 0 0 0-2.5z"/></svg>
              Instagram
            </a>
          </li>
          <li>
            <a class="social" href="https://www.tiktok.com/@heidi_insaisissable" target="_blank" rel="noopener noreferrer" aria-label="TikTok">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M13.5 3h3.1c.2 2.1 1.6 3.8 3.6 4.4v3.2c-1.5-.1-2.9-.6-4.1-1.4v6.7c0 4.2-3.5 7.6-7.8 7.1c-3.5-.4-6.2-3.6-6.2-7.1c0-4 3.2-7.2 7.2-7.2c.5 0 1 .1 1.5.2v3.5c-.5-.2-1-.3-1.5-.3c-2.1 0-3.8 1.7-3.8 3.8s1.7 3.9 3.8 3.9s3.8-1.7 3.8-3.8z"/></svg>
              TikTok
            </a>
          </li>
          <li>
            <a class="social" href="https://www.facebook.com/heidilemagicien" target="_blank" rel="noopener noreferrer" aria-label="Facebook">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M13 3h4a1 1 0 0 1 1 1v3h-3a1 1 0 0 0-1 1v3h4l-1 4h-3v8h-4v-8H7v-4h3V8a5 5 0 0 1 5-5z"/></svg>
              Facebook
            </a>
          </li>
          <li>
            <a class="social" href="https://www.youtube.com/channel/UCGrmuOW1GLlaekpv5t_sM6Q" target="_blank" rel="noopener noreferrer" aria-label="YouTube">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M23 12s0-3.3-.4-4.9c-.2-.9-.9-1.6-1.8-1.8C18.9 4.8 12 4.8 12 4.8s-6.9 0-8.8.5c-.9.2-1.6.9-1.8 1.8C1 8.7 1 12 1 12s0 3.3.4 4.9c.2.9.9 1.6 1.8 1.8c1.9.5 8.8.5 8.8.5s6.9 0 8.8-.5c.9-.2 1.6-.9 1.8-1.8c.4-1.6.4-4.9.4-4.9zM10 9.8l5.7 2.2L10 14.2V9.8z"/></svg>
              YouTube
            </a>
          </li>
        </ul>
      </aside>
    </div>
  </section>



  <section id="avis" class="section reviews">
    <div class="container">
      <header class="section-head">
        <h2 class="section-title">Avis Google</h2>
        <p class="section-sub">Des retours authentiques d’écoles, familles et entreprises : découvrez pourquoi mes prestations laissent des souvenirs durables.</p>
      </header>
      <div id="reviews" class="reviews-grid" aria-live="polite">
        <article class="review-card">
          <div class="review-header">
            <div class="review-author">
              <span class="review-avatar" aria-hidden="true">D</span>
              <span class="review-name">Daryl Parisi</span>
            </div>
            <div class="review-meta">
              <span class="review-stars" aria-label="Note 5 sur 5">★★★★★</span>
            </div>
          </div>
          <p class="review-text">J’ai eu l’occasion de profiter de ses services lors d’un anniversaire ! Les tarifs sont super raisonnable et Heidi est super doué et a si bluffé toute la salle !! Je recommande !!</p>
          <span class="review-time" data-visited="2022-05-01"></span>
        </article>

        <article class="review-card">
          <div class="review-header">
            <div class="review-author">
              <span class="review-avatar" aria-hidden="true">M</span>
              <span class="review-name">Morcamp Gwendoline</span>
            </div>
            <div class="review-meta">
              <span class="review-stars" aria-label="Note 5 sur 5">★★★★★</span>
            </div>
          </div>
          <p class="review-text">Nous avons eu la chance d'accueillir Heidi dans notre école pour un spectacle de magie inoubliable, et le mot est faible ! Les enfants comme les adultes ont été émerveillés du début à la fin. Heidi a su captiver son jeune public avec une énergie communicative, une grande bienveillance et un vocabulaire parfaitement adapté à l'âge des élèves.

Il a su créer une véritable émulsion dans la salle : rires, étonnements, curiosité... Les enfants étaient suspendus à ses gestes et à ses mots. Plus qu’un spectacle, c’était un vrai moment de partage et d’éveil à la magie.

Merci encore à Heidi pour cette belle parenthèse enchantée. Nous recommandons chaleureusement son spectacle à toutes les écoles, centres ou structures accueillant des enfants.</p>
          <span class="review-time" data-visited="2025-05-01"></span>
        </article>

        <article class="review-card">
          <div class="review-header">
            <div class="review-author">
              <span class="review-avatar" aria-hidden="true">F</span>
              <span class="review-name">Faustine Dufour</span>
            </div>
            <div class="review-meta">
              <span class="review-stars" aria-label="Note 5 sur 5">★★★★★</span>
            </div>
          </div>
          <p class="review-text">Merci Heidi de ta venue ! Les enfants étaient sous le charme complet et en parlent encore… Des étoiles plein les yeux, c’était un moment magique. Merci pour tout et à très vite</p>
          <span class="review-time" data-visited="2025-06-01"></span>
        </article>

        <article class="review-card">
          <div class="review-header">
            <div class="review-author">
              <span class="review-avatar" aria-hidden="true">F</span>
              <span class="review-name">Florinda Gameiro</span>
            </div>
            <div class="review-meta">
              <span class="review-stars" aria-label="Note 5 sur 5">★★★★★</span>
            </div>
          </div>
          <p class="review-text">Heidi Le Magicien a assuré la magie lors de la petite fête d anniversaire de notre fils de 6 ans. Il nous a tous bluffé (nous les parents, on en demandait encore ! ) Un vrai magicien sympathique et pro.
Nous recommandons vivement !</p>
          <span class="review-time" data-visited="2021-12-01"></span>
        </article>

        <article class="review-card">
          <div class="review-header">
            <div class="review-author">
              <span class="review-avatar" aria-hidden="true">J</span>
              <span class="review-name">jessica autier</span>
            </div>
            <div class="review-meta">
              <span class="review-stars" aria-label="Note 5 sur 5">★★★★★</span>
            </div>
          </div>
          <p class="review-text">Juste IMPRESSIONNANT !!!
Heidi est venu pour l'anniversaire de mon fils (7 ans) et c'était franchement INCROYABLE ! Les enfants ont ADORÉS, ont RIGOLÉS et ont été ÉMERVEILLÉS. Les yeux pleins D'ADMIRATIONS et de SURPRISES ! Et nous adultes exactement pareil 😃 c'était GÉNIAL !!!

En plus d'être un magicien FORMIDABLE, Heidi est vraiment sympathique et fait participer tout son public !

Je le recommande a 10000%

BRAVO Heidi 👏 et MERCI encore !</p>
          <span class="review-time" data-visited="2024-03-01"></span>
        </article>

        <article class="review-card">
          <div class="review-header">
            <div class="review-author">
              <span class="review-avatar" aria-hidden="true">A</span>
              <span class="review-name">adam ch</span>
            </div>
            <div class="review-meta">
              <span class="review-stars" aria-label="Note 5 sur 5">★★★★★</span>
            </div>
          </div>
          <p class="review-text">Monsieur Heidi le magicien est venu pour une fête d'anniversaire de 18 ans d'un ami, tours simples en apparence mais tous impressionant ! Tours de passe passe, de cartes, de boules, de pièces, même une corde coupée qui se reforme (en tout cas l'illusion marche très très bien !).</p>
          <span class="review-time" data-visited="2023-07-01"></span>
        </article>
        <!-- Read more toggle will be injected if needed -->
      </div>
      <div class="section-cta">
        <a id="reviews-more" class="btn btn-ghost" href="https://www.google.com/search?client=opera-gx&hs=tts&sca_esv=602bc0460517bd79&sxsrf=AE3TifNtA2u5Q_FZCUlGPCdDlMSx_pLqVg:1760721248604&si=AMgyJEtREmoPL4P1I5IDCfuA8gybfVI2d5Uj7QMwYCZHKDZ-E_2OuQ7zyPLv_PuAoRb-ttwmXe7ClOc9KJ8ErWJFGrhlgwqILd3PcgYtm48v9PG0neGr8S9Sav57n_OesuwiY_POHB1G&q=Heidi+Le+Magicien+Avis&sa=X&ved=2ahUKEwiu_8jk3auQAxVkTqQEHeH7CrMQ0bkNegQISRAD&biw=1875&bih=925&dpr=1" target="_blank" rel="noopener noreferrer">Voir tous les avis</a>
      </div>
    </div>
  </section>


  <section id="contact" class="section contact">
    <div class="container">
      <header class="section-head">
        <h2 class="section-title">Contact</h2>
        <p class="section-sub">Parlez-moi de votre événement. Réponse sous 24h.</p>
      </header>
      <form class="contact-form" action="mailto:contact.magie.heidi@gmail.com" method="post" enctype="text/plain" data-endpoint="" data-emailjs-service="service_7xnxkah" data-emailjs-template="template_vca49gf" data-emailjs-public="4sYz-WzrDCXInmUCl">
        <input type="hidden" name="_subject" value="Nouveau message — Heidi le Magicien">
        <div class="form-grid">
          <label class="field">
            <span>Nom</span>
            <input type="text" name="from_name" placeholder="Votre nom" required>
          </label>
          <label class="field">
            <span>Email</span>
            <input type="email" name="from_email" placeholder="vous@exemple.com" required>
          </label>
          <label class="field">
            <span>Téléphone</span>
            <input type="tel" name="from_phone" placeholder="06 12 34 56 78" required>
          </label>
          <label class="field full">
            <span>Message</span>
            <textarea name="message" rows="5" placeholder="Date, lieu, type d’événement…" required></textarea>
          </label>
        </div>
        <div class="form-actions">
          <button class="btn btn-primary" type="submit">Envoyer</button>
          <a class="btn btn-ghost" href="mailto:contact.magie.heidi@gmail.com">Ou écrire directement</a>
        </div>
        <p class="form-note" aria-live="polite">En cliquant sur « Envoyer », vous acceptez d’être recontacté par email.</p>
      </form>
    </div>
  </section>

  <footer class="site-footer">
    <div class="container footer-inner">
      <p>© <span id="year"></span> Heidi — Magicien professionnel. Tous droits réservés.</p>
      <a href="#accueil" class="back-to-top">Retour en haut</a>
    </div>
  </footer>

  <script>
    // Mobile nav toggle
    const toggle = document.querySelector('.nav-toggle');
    const menu = document.getElementById('nav-menu');
    if (toggle && menu) {
      toggle.addEventListener('click', () => {
        const expanded = toggle.getAttribute('aria-expanded') === 'true';
        toggle.setAttribute('aria-expanded', String(!expanded));
        menu.classList.toggle('open');
      });
    }
    // Footer year
    const y = document.getElementById('year');
    if (y) y.textContent = String(new Date().getFullYear());

    // Playing card flip interactions
    const cards = document.querySelectorAll('.playing-card');
    cards.forEach((card) => {
      card.addEventListener('click', () => {
        const pressed = card.getAttribute('aria-pressed') === 'true';
        card.setAttribute('aria-pressed', String(!pressed));
      });
      card.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          const pressed = card.getAttribute('aria-pressed') === 'true';
          card.setAttribute('aria-pressed', String(!pressed));
        }
      });
    });
  </script>
  <script>
    // Clamp long reviews and add "Lire plus / Lire moins" toggles
    (function () {
      document.querySelectorAll('.review-card').forEach(card => {
        const text = card.querySelector('.review-text');
        if (!text) return;
        // Start unclamped to measure natural height
        card.classList.remove('is-clamped');
        const naturalHeight = text.scrollHeight;
        // Apply clamp and compare
        card.classList.add('is-clamped');
        const clampedHeight = text.clientHeight;
        const needsToggle = naturalHeight > clampedHeight + 2; // tolerance
        if (needsToggle) {
          let toggle = card.querySelector('.review-readmore');
          if (!toggle) {
            toggle = document.createElement('button');
            toggle.type = 'button';
            toggle.className = 'review-readmore';
            toggle.textContent = 'Lire plus';
            text.insertAdjacentElement('afterend', toggle);
          }
          toggle.addEventListener('click', () => {
            const clamped = card.classList.toggle('is-clamped');
            toggle.textContent = clamped ? 'Lire plus' : 'Lire moins';
          });
        }
      });
    })();
  </script>
  <script>
    // Render relative time for reviews with data-visited="YYYY-MM-01"
    (function () {
      function monthNameFr(m) {
        return ['janvier','février','mars','avril','mai','juin','juillet','août','septembre','octobre','novembre','décembre'][m];
      }
      function formatRelative(from, to) {
        const ms = to - from;
        const days = Math.floor(ms / 86400000);
        const months = Math.floor(days / 30.4375);
        const years = Math.floor(months / 12);
        if (years >= 1) return years === 1 ? 'il y a un an' : `il y a ${years} ans`;
        if (months >= 1) return months === 1 ? 'il y a 1 mois' : `il y a ${months} mois`;
        const weeks = Math.floor(days / 7);
        if (weeks >= 1) return weeks === 1 ? 'il y a 1 semaine' : `il y a ${weeks} semaines`;
        return days <= 1 ? 'il y a 1 jour' : `il y a ${days} jours`;
      }
      const now = new Date();
      document.querySelectorAll('.review-time[data-visited]')?.forEach(el => {
        const iso = el.getAttribute('data-visited');
        if (!iso) return;
        const visited = new Date(iso);
        const rel = formatRelative(visited, now);
        const monthYear = `${monthNameFr(visited.getMonth())} ${visited.getFullYear()}`;
        el.textContent = `${rel} — Visité en ${monthYear}`;
      });
    })();
  </script>
  
  <script>
    // Hero particles animation
    (function () {
      const container = document.querySelector('.hero-slogan');
      if (!container) return;
      const canvas = container.querySelector('.hero-particles');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      const dpr = Math.min(window.devicePixelRatio || 1, 2);
      let width = 0, height = 0;
      let running = false, rafId = 0;
      let particles = [];
      const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)');

      function rand(min, max) { return Math.random() * (max - min) + min; }

      function initParticles() {
        const count = Math.round(Math.min(140, Math.max(50, (width * height) / 5500)));
        particles = new Array(count).fill(0).map(() => ({
          x: rand(0, width),
          y: rand(0, height),
          r: rand(0.35, 1.2),
          vx: rand(-0.15, 0.15),
          vy: rand(-0.25, -0.05),
          life: rand(2, 6),
          age: rand(0, 6),
          tw: rand(0.5, 2.5)
        }));
      }

      function resize() {
        const rect = container.getBoundingClientRect();
        const baseW = Math.max(1, Math.floor(rect.width));
        const baseH = Math.max(1, Math.floor(rect.height));
        const pad = 0.25; // extend ~25% on each side
        width = Math.floor(baseW * (1 + pad * 2));
        height = Math.floor(baseH * (1 + pad * 2));
        canvas.width = Math.floor(width * dpr);
        canvas.height = Math.floor(height * dpr);
        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';
        canvas.style.left = (-Math.floor(baseW * pad)) + 'px';
        canvas.style.top = (-Math.floor(baseH * pad)) + 'px';
        canvas.style.right = 'auto';
        canvas.style.bottom = 'auto';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        initParticles();
      }

      function drawParticle(p) {
        const grad = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r * 2.4);
        grad.addColorStop(0, 'rgba(249,231,159,.85)');
        grad.addColorStop(0.35, 'rgba(227,199,120,.55)');
        grad.addColorStop(1, 'rgba(198,161,91,0)');
        ctx.fillStyle = grad;
        const twinkle = 0.65 + Math.sin((p.age + p.tw) * 1.6) * 0.35;
        ctx.globalAlpha = Math.max(0, Math.min(1, twinkle));
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r * 2.2, 0, Math.PI * 2);
        ctx.fill();
      }

      function step(dt) {
        ctx.clearRect(0, 0, width, height);
        ctx.globalCompositeOperation = 'lighter';
        for (const p of particles) {
          p.age += dt;
          p.x += p.vx + Math.sin((p.age + p.r) * 0.6) * 0.05;
          p.y += p.vy;
          if (p.y < -6) { p.y = height + 6; p.x = rand(0, width); }
          if (p.x < -6) p.x = width + 6; else if (p.x > width + 6) p.x = -6;
          drawParticle(p);
        }
        ctx.globalCompositeOperation = 'source-over';
      }

      let last = performance.now();
      function loop(now) {
        if (!running) return;
        const dt = Math.min(0.033, (now - last) / 1000);
        last = now;
        step(dt);
        rafId = requestAnimationFrame(loop);
      }

      function start() {
        if (prefersReduce.matches) {
          resize();
          ctx.clearRect(0, 0, width, height);
          ctx.globalCompositeOperation = 'lighter';
          for (const p of particles) drawParticle(p);
          ctx.globalCompositeOperation = 'source-over';
          return;
        }
        if (running) return;
        running = true;
        last = performance.now();
        rafId = requestAnimationFrame(loop);
      }

      function stop() {
        running = false;
        cancelAnimationFrame(rafId);
      }

      resize();
      start();
      window.addEventListener('resize', resize);
      document.addEventListener('visibilitychange', () => {
        if (document.hidden) stop(); else start();
      });
    })();
  </script>
  <script>
    // Phone particles animation (scoped to .phone-bg)
    (function () {
      const container = document.querySelector('.phone-bg');
      if (!container) return;
      const canvas = container.querySelector('.phone-particles');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      const dpr = Math.min(window.devicePixelRatio || 1, 2);
      let width = 0, height = 0;
      let running = false, rafId = 0;
      let particles = [];
      const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)');

      function rand(min, max) { return Math.random() * (max - min) + min; }

      function initParticles() {
        const count = Math.round(Math.min(120, Math.max(40, (width * height) / 7000)));
        particles = new Array(count).fill(0).map(() => ({
          x: rand(0, width),
          y: rand(0, height),
          r: rand(0.28, 1.0),
          vx: rand(-0.12, 0.12),
          vy: rand(-0.22, -0.04),
          life: rand(2, 6),
          age: rand(0, 6),
          tw: rand(0.5, 2.5)
        }));
      }

      function resize() {
        const rect = container.getBoundingClientRect();
        width = Math.max(1, Math.floor(rect.width));
        height = Math.max(1, Math.floor(rect.height));
        canvas.width = Math.floor(width * dpr);
        canvas.height = Math.floor(height * dpr);
        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        initParticles();
      }

      function drawParticle(p) {
        const grad = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r * 2.2);
        grad.addColorStop(0, 'rgba(249,231,159,.8)');
        grad.addColorStop(0.35, 'rgba(227,199,120,.5)');
        grad.addColorStop(1, 'rgba(198,161,91,0)');
        ctx.fillStyle = grad;
        const twinkle = 0.6 + Math.sin((p.age + p.tw) * 1.6) * 0.35;
        ctx.globalAlpha = Math.max(0, Math.min(1, twinkle));
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r * 2, 0, Math.PI * 2);
        ctx.fill();
      }

      function step(dt) {
        ctx.clearRect(0, 0, width, height);
        ctx.globalCompositeOperation = 'lighter';
        for (const p of particles) {
          p.age += dt;
          p.x += p.vx + Math.sin((p.age + p.r) * 0.6) * 0.05;
          p.y += p.vy;
          if (p.y < -6) { p.y = height + 6; p.x = rand(0, width); }
          if (p.x < -6) p.x = width + 6; else if (p.x > width + 6) p.x = -6;
          drawParticle(p);
        }
        ctx.globalCompositeOperation = 'source-over';
      }

      let last = performance.now();
      function loop(now) {
        if (!running) return;
        const dt = Math.min(0.033, (now - last) / 1000);
        last = now;
        step(dt);
        rafId = requestAnimationFrame(loop);
      }

      function start() {
        if (prefersReduce.matches) {
          resize();
          ctx.clearRect(0, 0, width, height);
          ctx.globalCompositeOperation = 'lighter';
          for (const p of particles) drawParticle(p);
          ctx.globalCompositeOperation = 'source-over';
          return;
        }
        if (running) return;
        running = true;
        last = performance.now();
        rafId = requestAnimationFrame(loop);
      }

      function stop() {
        running = false;
        cancelAnimationFrame(rafId);
      }

      resize();
      start();
      window.addEventListener('resize', resize);
      document.addEventListener('visibilitychange', () => {
        if (document.hidden) stop(); else start();
      });
    })();
  </script>
  <canvas class="cursor-trail" aria-hidden="true"></canvas>
  <script>
    // Golden cursor trail
    (function () {
      const canvas = document.querySelector('.cursor-trail');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      const dpr = Math.min(window.devicePixelRatio || 1, 2);
      let width = 0, height = 0;
      let particles = [];
      let lastTime = performance.now();
      const maxAge = 0.9; // seconds
      const spawnRate = 1 / 1000; // per ms when moving
      let spawnAccumulator = 0;
      let mouseX = -1000, mouseY = -1000, lastX = -1000, lastY = -1000;
      let isMoving = false;

      function resize() {
        width = Math.max(1, Math.floor(window.innerWidth));
        height = Math.max(1, Math.floor(window.innerHeight));
        canvas.width = Math.floor(width * dpr);
        canvas.height = Math.floor(height * dpr);
        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }

      function onMove(e) {
        lastX = mouseX; lastY = mouseY;
        mouseX = e.clientX; mouseY = e.clientY;
        isMoving = true;
      }
      window.addEventListener('mousemove', onMove, { passive: true });

      function spawnParticle(x, y) {
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 40 + 20; // px/s
        particles.push({
          x, y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed - 10,
          r: Math.random() * 1.2 + 0.5,
          age: 0,
          tw: Math.random() * 2,
        });
      }

      function step(dt) {
        // spawn along path if moving
        if (isMoving && lastX > -999) {
          const dx = mouseX - lastX, dy = mouseY - lastY;
          const dist = Math.hypot(dx, dy);
          const steps = Math.max(1, Math.floor(dist / 6));
          for (let i = 0; i < steps; i++) {
            spawnAccumulator += dt * 1000; // ms
            if (spawnAccumulator >= 0) {
              const t = i / steps;
              spawnParticle(lastX + dx * t, lastY + dy * t);
              spawnAccumulator -= 1000 * spawnRate;
            }
          }
        }
        isMoving = false;

        // physics
        ctx.clearRect(0, 0, width, height);
        ctx.globalCompositeOperation = 'lighter';
        const gravity = 60; // px/s^2
        const drag = 0.98;
        particles = particles.filter(p => p.age < maxAge);
        for (const p of particles) {
          p.age += dt;
          p.vy += gravity * dt;
          p.vx *= drag; p.vy *= drag;
          p.x += p.vx * dt;
          p.y += p.vy * dt;

          const life = 1 - (p.age / maxAge);
          const grad = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r * 5);
          grad.addColorStop(0, `rgba(249,231,159,${0.65 * life})`);
          grad.addColorStop(0.35, `rgba(227,199,120,${0.45 * life})`);
          grad.addColorStop(1, 'rgba(198,161,91,0)');
          ctx.fillStyle = grad;
          ctx.globalAlpha = 0.8 * (0.65 + Math.sin((p.age + p.tw) * 10) * 0.35) * life;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r * 3.2, 0, Math.PI * 2);
          ctx.fill();
        }
        ctx.globalCompositeOperation = 'source-over';
      }

      function loop(now) {
        const dt = Math.min(0.033, (now - lastTime) / 1000);
        lastTime = now;
        step(dt);
        requestAnimationFrame(loop);
      }

      resize();
      window.addEventListener('resize', resize);
      requestAnimationFrame(loop);
    })();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    // EmailJS init (reads keys from the contact form data-attributes)
    (function () {
      const form = document.querySelector('#contact .contact-form');
      if (!form || typeof window.emailjs === 'undefined') return;
      const publicKey = form.getAttribute('data-emailjs-public');
      if (publicKey) {
        try { window.emailjs.init({ publicKey }); } catch (_) { /* noop */ }
      }
    })();
  </script>
  <script>
    // Contact form: progressive enhancement
    (function () {
      const form = document.querySelector('#contact .contact-form');
      if (!form) return;
      const endpoint = form.getAttribute('data-endpoint');
      const publicKey = form.getAttribute('data-emailjs-public');
      const serviceId = form.getAttribute('data-emailjs-service');
      const templateId = form.getAttribute('data-emailjs-template');
      const hasEmailJS = (typeof window.emailjs !== 'undefined') && publicKey && serviceId && templateId;

      form.addEventListener('submit', async (e) => {
        const note = form.querySelector('.form-note');
        const submitBtn = form.querySelector('button[type="submit"]');
        const ghostLink = form.querySelector('.btn-ghost[href^="mailto:"]');
        function setStatus(msg, kind) {
          if (note) {
            note.textContent = msg;
            note.style.color = kind === 'error' ? 'var(--danger)' : kind === 'success' ? 'var(--success)' : 'var(--muted)';
          }
        }

        if (hasEmailJS) {
          e.preventDefault();
          try {
            submitBtn && (submitBtn.disabled = true);
            setStatus('Envoi en cours…', 'info');
            const res = await window.emailjs.sendForm(serviceId, templateId, form);
            if (!res || (res.status && res.status >= 400)) throw new Error('EmailJS error');
            form.reset();
            setStatus('Message envoyé ! Je vous réponds sous 24h.', 'success');
            ghostLink && (ghostLink.style.display = 'none');
          } catch (err) {
            setStatus("Échec de l’envoi. Vous pouvez cliquer sur ‘Ou écrire directement’.", 'error');
          } finally {
            submitBtn && (submitBtn.disabled = false);
          }
          return;
        }

        if (endpoint) {
          e.preventDefault();
          try {
            submitBtn && (submitBtn.disabled = true);
            setStatus('Envoi en cours…', 'info');
            const data = new FormData(form);
            const res = await fetch(endpoint, { method: 'POST', body: data, headers: { 'Accept': 'application/json' } });
            if (!res.ok) throw new Error('HTTP ' + res.status);
            form.reset();
            setStatus('Message envoyé ! Je vous réponds sous 24h.', 'success');
            ghostLink && (ghostLink.style.display = 'none');
          } catch (err) {
            setStatus("Échec de l’envoi. Vous pouvez cliquer sur ‘Ou écrire directement’.", 'error');
          } finally {
            submitBtn && (submitBtn.disabled = false);
          }
          return;
        }
        // else: no JS handling — let mailto action proceed
      });
    })();
  </script>
</body>
</html>


